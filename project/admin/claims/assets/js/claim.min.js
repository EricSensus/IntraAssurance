$(function(){if("undefined"!=typeof SITE_PATH){PNotify.prototype.options.styling="fontawesome";var e={dir1:"down",dir2:"right",push:"top",modal:!0,overlay_close:!0},t=SITE_PATH+"/ajax/admin/policies/getcustomer",o=$(".chosen-select"),l=$("#btnsubmit"),i=$("#policy_preview"),n=$(".select-quote"),a=$("#claim-details");l.hide();var c={initCustomerSelect:function(){a.hide(),o.empty(),o.select2({minimumInputLength:2,theme:"bootstrap",placeholder:"Select a customer",allowClear:!0,ajax:{url:t,dataType:"json",delay:250,data:function(e){return{query:e.term,page:e.page}},processResults:function(e,t){return t.page=t.page||1,{results:e.results,pagination:{more:30*t.page<e.total_count}}},cache:!0}}),o.on("select2:select",function(){c.selectCustomer(this.value)}),$(document).on("change","#policies",function(){c.selectPolicy()}),$(document).on("click","#proceed",function(){$(this).hide(),new PNotify({text:"Please enter claim details",type:"info"}),a.show()})},selectCustomer:function(t){$.ajax({url:SITE_PATH+"/ajax/admin/claims/getpolicies?id="+t,type:"GET",dataType:"json",beforeSend:function(){n.html(PRELOADER2),i.html("")},success:function(l){if(l.status)$("#embedded_quote").html(""),n.html('<label id="label_quote" for="select-quote">Select a policy to use for the New Claim</label>'+l.content),$("input[name=customer_id]").val(t);else{var i=null;try{i=o.select2("data")[0].text}catch(e){i="Selected Customer"}n.html(""),o.val(null).trigger("change"),new PNotify({text:"No policies found for the <strong>"+i+"</strong>",type:"error",stack:e,addclass:"stack-modal"})}}})},selectPolicy:function(){var e=$("#policies").val();if(""===e)return void new PNotify({text:"Please select policy",type:"info"});$.ajax({url:SITE_PATH+"/ajax/admin/claims/getpolicypreview?id="+e,type:"GET",beforeSend:function(){a.hide(),i.html(PRELOADER2)},success:function(t){i.html(t),l.show(),$("input[name=policy_id]").val(e),console.log(e)}})}};c.initCustomerSelect()}});