$(function(){var e=$("#btnSubmit"),a=$("#next"),t=$("#prev");e.hide(),t.hide();var n={tab:"tab2",addDependantTab:function(e){$(".tab22").removeClass("hide"),$("div#tab22").html(e)},removeDependantTab:function(){$(".tab22").addClass("hide")},generateQuote:function(e,a){$.ajax({url:e+"/admin/quote/getquote/medical",type:"GET",success:function(t){$(".med").html(t);var n=encodeURI("policies/createpolicy/"+a);$(document).find("#proceed_with_policy").attr("href",e+"/ajax/admin/quotes/internalacceptquote/"+a+"?return="+n)}})},switchToQuote:function(){$(".med").html($("span#preloader").html()),$(".tab4").removeClass("hide"),$("li > a[href=#tab4]").click()}},i=$("#site_path").val();$(".datepicker").datepicker({dateFormat:"yy-mm-dd",changeYear:!0,changeMonth:!0,maxDate:"-15Y"}),$(document).find("input:radio, input:checkbox").css("display","inline"),e.click(function(){o.isFormValid()}),$('a[data-toggle="tab"]').on("shown.bs.tab",function(e){o.updateBtn(e)}),$("#prev").click(function(){o.moveTab("prev")}),$("#next").click(function(){o.moveTab("next")});var o={isFormValid:function(){var e=!0;if($("input:required,select:required,textarea:required").each(function(){0==$.trim($(this).val()).length||"0.00"==$.trim($(this).val())?($(this).parent().addClass("form-group has-error"),e=!1):$(this).parent().removeClass("has-error")}),e){var a=!1,t="";if(n.switchToQuote(),$("form").each(function(){var e=$(this);$.ajax({url:e.attr("action"),type:"POST",data:e.serialize()+"&request_type=__ajax",async:!1,dataType:"json",success:function(e){e.success?(a=!0,void 0!=e.quote_id&&(t=e.quote_id)):a=!1}})}),a)return n.generateQuote(i,t),!1}else{var o=$(".has-error:first").parents("div.tab-pane").attr("id");$("a[href=#"+o+"]").click()}},updateBtn:function(n){var i=$(n.target).attr("href");e.hide(),a.hide(),t.hide(),"#tab3"===i?(a.hide(),t.show(),e.show()):"#tab1"===i?(t.hide(),a.show()):(t.show(),a.show())},moveTab:function(e){var a=$(".nav-tabs li.active");sibbling="next"===e?a.next():a.prev(),sibbling.is("li")&&sibbling.children("a").tab("show")}};$("#additional_covers").on("change",function(){var e=$(this),a=parseInt(e.val());a>=1?$.ajax({url:i+"/medical/load/"+a,type:"GET",dataType:"json",success:function(e){e.success&&n.addDependantTab(e.form.form)}}):n.removeDependantTab()}),$('[data-toggle="popover"]').popover({container:"body"}),$('input[name="core_plans"]').on("click",function(){$('input[name="core_plans"]').each(function(){$(this).parents("div.panel:first").removeClass("highlight-plan")}),$(this).parents("div.panel:first").addClass("highlight-plan")}),$('input[name="have_dependants"]').on("click",function(){Common.makeMandatory($(this).val(),"#additional_covers")}),$('input[name="ever_cover_declined"]').on("click",function(){Common.makeMandatory($(this).val(),"#declined_particulars")}),$('input[name="dependant_claimed_cover"]').on("click",function(){Common.makeMandatory($(this).val(),"#dep_claimed_particulars")});var r={autoFill:function(e){$.each(e,function(e,a){var t=$("[name="+e+"]");t.is(":checkbox")?t.attr("checked","checked"):t.is(":radio")?$("input[name="+e+"][value="+a+"]").attr("checked","checked"):t.val(a)})}};"undefined"!=typeof customer_data&&r.autoFill(customer_data),"undefined"!=typeof product_info&&r.autoFill(product_info);var c=$("#additional_covers").removeAttr("disabled").val();c>=1?$.ajax({url:i+"/medical/load/"+c,type:"GET",dataType:"json",async:!1,success:function(e){e.success&&n.addDependantTab(e.form.form)}}):n.removeDependantTab(),"undefined"!=typeof entity_data&&r.autoFill(entity_data)});