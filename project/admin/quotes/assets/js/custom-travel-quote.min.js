$(function(){var a=$("#btnSubmit"),i=$("#next"),o=$("#prev");a.hide(),o.hide();var t={loadMore:function(a){var i="";if(a=parseInt(a))for(var o=1;o<=a;o++)i+='<div class="row">',i+='<div class="col-md-3">',i+='<div class="form-group">',i+="<label>Name</label>",i+='<input type="text" name="companion_name'+o+'" class="form-control"/>',i+="</div>",i+="</div>",i+='<div class="col-md-3">',i+='<div class="form-group">',i+="<label>Occupation</label>",i+='<input type="text" name="companion_occupation'+o+'" class="form-control"/>',i+="</div>",i+="</div>",i+='<div class="col-md-3">',i+='<div class="form-group">',i+="<label>Date of Birth</label>",i+='<input type="text" name="companion_dob'+o+'" class="form-control datepicker"/>',i+="</div>",i+="</div>",i+='<div class="col-md-3">',i+='<div class="form-group">',i+="<label>Relationship with the Proposer</label>",i+='<select type="text" name="companion_relationship'+o+'" class="form-control"><option value="wife">wife</option><option value="husband">husband</option><option value="son">son</option><option value="daughter">daughter</option><option value="other">other</option></select>',i+="</div>",i+="</div>",i+="</div>",i+='<div class="row">',i+='<div class="col-md-3">',i+='<div class="form-group">',i+="<label>Passport Number</label>",i+='<input type="text" name="companion_passport'+o+'" class="form-control"/>',i+="</div>",i+="</div>",i+='<div class="col-md-3">',i+='<div class="form-group">',i+="<label>Plan</label>",i+='<input type="text" name="companion_plan'+o+'" class="form-control"/>',i+="</div>",i+="</div>",i+='<div class="col-md-3">',i+='<div class="form-group">',i+="<label>No of days</label>",i+='<input type="number" name="companion_no_of_days'+o+'" class="form-control"/>',i+="</div>",i+="</div>",i+="</div>",i+="<hr/>";$("div#companion_inputs").html(i)},generateQuote:function(a,i){$.ajax({url:a+"/admin/quote/getquote/travel",type:"GET",success:function(o){console.log(i),$(".travel").html(o);var t=encodeURI("policies/createpolicy/"+i);$(document).find("#proceed_with_policy").attr("href",a+"/ajax/admin/quotes/internalacceptquote/"+i+"?return="+t)}})},switchToQuote:function(){$(".travel").html($("span#preloader").html()),$(".tab4").removeClass("hide"),$("li > a[href=#tab4]").click()}};$("#site_path").val();$(".datepicker").datepicker({dateFormat:"yy-mm-dd",changeYear:!0,changeMonth:!0,maxDate:"-15Y"}),$(document).find('input[id^="cover_plan"], input[id^="add_travel_companions"], input[id^="i_agree"]').css("display","inline"),$('input:radio[id^="add_travel_companions"]').on("click",function(){Common.makeMandatory($(this).val(),"select#no_of_travel_companions"),parseInt($(this).val())||$("div#companion_inputs").html("")}),$('input:radio[id^="physical_disability"]').on("click",function(){Common.makeMandatory($(this).val(),"#phy_dis_particulars")}),$('input:radio[id^="good_health"]').on("click",function(){Common.makeMandatory($(this).val(),"#health_particulars")}),$('input:radio[id^="medical_treatment"]').on("click",function(){Common.makeMandatory($(this).val(),"#med_treat_particulars")}),$('input:radio[id^="disorders"]').on("click",function(){Common.makeMandatory($(this).val(),"#dis_particulars")}),$('input:radio[id^="cancelled_prev_insurance"]').on("click",function(){Common.makeMandatory($(this).val(),"#prev_ins_cancelled")}),$('input:radio[id^="already_insured"]').on("click",function(){Common.makeMandatory($(this).val(),"#already_ins_particulars")}),$('input:radio[id^="claimed"]').on("click",function(){Common.makeMandatory($(this).val(),"#claimed79_particulars")}),$('input:radio[id^="i_agree"]').on("click",function(){Common.makeMandatory($(this).val(),"#gen_quote")}),$("#no_of_travel_companions").on("change",function(){var a=$(this).val();t.loadMore(a)}),$(document).find('input[id^="cover_plan"], input[id^="add_travel_companions"], input[id^="i_agree"]').css("display","inline"),a.click(function(){e.isFormValid()}),$('a[data-toggle="tab"]').on("shown.bs.tab",function(a){e.updateBtn(a)}),$("#prev").click(function(){e.moveTab("prev")}),$("#next").click(function(){e.moveTab("next")});var e={isFormValid:function(){var a=!0;if($("input:required,select:required,textarea:required").each(function(){0==$.trim($(this).val()).length||"0.00"==$.trim($(this).val())?($(this).parent().addClass("form-group has-error"),a=!1):$(this).parent().removeClass("has-error")}),a){var i=!1,o="";t.switchToQuote(),$("form").each(function(){var a=$(this);$.ajax({url:a.attr("action"),type:"POST",data:a.serialize()+"&request_type=__ajax",async:!1,dataType:"json",success:function(a){a.success?(i=!0,void 0!=a.quote_id&&(o=a.quote_id)):i=!1}})});var e=$("#site_path").val();if(i)return t.generateQuote(e,o),!1}else{var n=$(".has-error:first").parents("div.tab-pane").attr("id");$("a[href=#"+n+"]").click()}},updateBtn:function(t){var e=$(t.target).attr("href");a.hide(),i.hide(),o.hide(),"#tab3"===e?(i.hide(),o.show(),a.show()):"#tab1"===e?(o.hide(),i.show()):(o.show(),i.show())},moveTab:function(a){var i=$(".nav-tabs li.active");sibbling="next"===a?i.next():i.prev(),console.log(i,sibbling),sibbling.is("li")&&sibbling.children("a").tab("show")}},n={autoFill:function(a){$.each(a,function(a,i){var o=$("[name="+a+"]");o.is(":checkbox")?o.attr("checked","checked"):o.is(":radio")?$("input[name="+a+"][value="+i+"]").attr("checked","checked"):o.val(i)})}};"undefined"!=typeof customer_data&&n.autoFill(customer_data),"undefined"!=typeof product_info&&n.autoFill(product_info);var r=$("#no_of_travel_companions").removeAttr("disabled").val();t.loadMore(r),"undefined"!=typeof entity_data&&n.autoFill(entity_data)});